<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>write_fits_cut4</TITLE>
<META NAME="description" CONTENT="write_fits_cut4">
<META NAME="keywords" CONTENT="subroutines">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="subroutines.css">

<LINK REL="next" HREF="subroutinesnode110.htm">
<LINK REL="previous" HREF="subroutinesnode108.htm">
<LINK REL="up" HREF="subroutines.htm">
<LINK REL="next" HREF="subroutinesnode110.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html1579"
  HREF="subroutinesnode108.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1585"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1589"
  HREF="subroutinesnode110.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1587"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1580"
  HREF="subroutinesnode108.htm">write_dbintab</A>

<B>Up:</B> <A NAME="tex2html1586"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html1590"
  HREF="subroutinesnode110.htm">write_minimal_header</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION0001090000000000000000"></A>
<A NAME="sub:write_fits_cut4"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">write_fits_cut4</FONT></font></b><hr>
<H3>This routine writes a cut sky <b>HEALPix</b> map into a FITS file. The format used for the
FITS file follows the one used for Boomerang98 and is adapted from COBE/DMR. 
This routine can be used to store polarized maps, where the
information relative to the Stokes parameters I, Q and U are placed in extension
0, 1 and 2 respectively by successive invocation of the routine.</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/806/tree/trunk/src/f90/mod/fitstools.F90"><b>src/f90/mod/fitstools.F90</b></a>&nbsp;  

<P>
<hr><h1>FORMAT </h1><blockquote><h3>call <FONT COLOR="#CC0000">write_fits_cut4</FONT>(
<A HREF="#sub:write_fits_cut4:filename">filename</A>, <A HREF="#sub:write_fits_cut4:np">np</A>, <A HREF="#sub:write_fits_cut4:pixel">pixel</A>, <A HREF="#sub:write_fits_cut4:signal">signal</A>, <A HREF="#sub:write_fits_cut4:n_obs">n_obs</A>, <A HREF="#sub:write_fits_cut4:serror">serror</A><i><font color="#224422">[, <A HREF="#sub:write_fits_cut4:header">header</A>, <A HREF="#sub:write_fits_cut4:coord">coord</A>, <A HREF="#sub:write_fits_cut4:nside">nside</A>, <A HREF="#sub:write_fits_cut4:order">order</A>,
<A HREF="#sub:write_fits_cut4:units">units</A>, <A HREF="#sub:write_fits_cut4:extno">extno</A>, <A HREF="#sub:write_fits_cut4:polarisation">polarisation</A>]</font></i>
)</h3></blockquote>
Arguments appearing in <i><font color="#224422">italic</font></i> are
optional.

<P>
<hr><H1>ARGUMENTS</H1>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=150><SPAN  CLASS="textbf">name&amp;dimensionality</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">kind</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">in/out</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=250><SPAN  CLASS="textbf">description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>
filename<A NAME="sub:write_fits_cut4:filename"></A>(LEN=<tt>filenamelen</tt>)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>FITS file to be read from,
                   containing a cut sky map</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>np<A NAME="sub:write_fits_cut4:np"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>number of pixels to be written in the file</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>pixel<A NAME="sub:write_fits_cut4:pixel"></A>(0:np-1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>index of observed (or valid) pixels</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>signal<A NAME="sub:write_fits_cut4:signal"></A>(0:np-1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>value of signal in each observed pixel</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>n_obs<A NAME="sub:write_fits_cut4:n_obs"></A>(0:np-1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>number of observation per pixel</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>serror<A NAME="sub:write_fits_cut4:serror"></A>(0:np-1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250><EM>rms</EM> of signal in pixel, for white noise,
                   this is <!-- MATH
 $\propto 1/\sqrt{{\rm n\_obs}}$
 -->
<SPAN CLASS="MATH"><IMG
 WIDTH="104" HEIGHT="44" ALIGN="MIDDLE" BORDER="0"
 SRC="subroutinesimg126.png"
 ALT="$ \propto 1/\sqrt{{\rm n\_obs}}$"></SPAN>.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">header<A NAME="sub:write_fits_cut4:header"></A></font></i>(LEN=80)(1:)  (OPTIONAL)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>FITS extension header</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">coord<A NAME="sub:write_fits_cut4:coord"></A></font></i>(LEN=1)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>astrophysical coordinates ('C' or 'Q'
                   Celestial/eQuatorial, 'G' for Galactic, 'E' for Ecliptic)</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">nside<A NAME="sub:write_fits_cut4:nside"></A></font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250><b>HEALPix</b> resolution parameter of data set</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">order<A NAME="sub:write_fits_cut4:order"></A></font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250><b>HEALPix</b> ordering scheme, 1: RING, 2: NESTED</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">header<A NAME="sub:write_fits_cut4:header"></A></font></i>(LEN=80)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>FITS header to be included in the FITS file</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">units<A NAME="sub:write_fits_cut4:units"></A></font></i>(LEN=20)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>maps units (applies only to Signal and
                   Serror)</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">extension</font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>(0 based) extension number in which to write data. <b>default:</b>0.
	  If set to 0 (or not set) <EM>a new file is written from scratch</EM>.
	  If set to a value
		  larger than 1, the corresponding extension is added or
		  updated, as long as all previous extensions already exist.
		  All extensions of the same file should use the same Nside,
Order and Coord</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150><i><font color="#224422">polarisaton</font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>if set to a non zero value, specifies that file will contain the I, Q and U polarisation
           Stokes parameter in extensions 0, 1 and 2 respectively, and sets the
FITS header keywords accordingly. If not set, the keywords found in <TT>header<A NAME="sub:write_fits_cut4:header"></A></TT> will prevail.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=150>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=250>Note: the information relative to Nside, Order and Coord <EM>has</EM> to be
                   given, either thru these keyword or via the FITS Header.</TD>
</TR>
</TABLE>

<P>

<hr><H1>MODULES & ROUTINES</H1><H3>This section lists the modules and routines used by <FONT COLOR="#CC0000">write_fits_cut4</FONT>.</h3>
  <DL COMPACT><DT>
<B><SPAN  CLASS="textbf">fitstools</SPAN></B>
<DD>module, containing:
  <DT>
<B>printerror</B>
<DD>routine for printing FITS error messages.
  <DT>
<B><SPAN  CLASS="textbf">cfitsio</SPAN></B>
<DD>library for FITS file handling.		
  </DL>

<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">write_fits_cut4</FONT></b></h3>
 
  <DL COMPACT><DT>
<B>anafast</B>
<DD>executable that reads a <b>HEALPix</b> map and analyses it. 
  <DT>
<B>synfast</B>
<DD>executable that generate full sky <b>HEALPix</b> maps
  <DT>
<B><A HREF="subroutinesnode39.htm#sub:getsize_fits">getsize_fits</A></B>
<DD>routine to know the size of a FITS file and its type (eg, full sky vs cut sky)
  <DT>
<B><A HREF="subroutinesnode43.htm#sub:input_map">input_map</A></B>
<DD>all purpose routine to input a map of any kind from a FITS file
  <DT>
<B><A HREF="subroutinesnode69.htm#sub:output_map">output_map</A></B>
<DD>subroutine to write a FITS file from a <b>HEALPix</b> map
  <DT>
<B><A HREF="subroutinesnode86.htm#sub:read_fits_cut4">read_fits_cut4</A></B>
<DD>subroutine to read a <b>HEALPix</b> cut sky map from a FITS file
  <DT>
<B><A HREF="subroutinesnode110.htm#sub:write_minimal_header">write_minimal_header</A></B>
<DD>routine to write minimal FITS header
  </DL>

<P>

<P>


<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1579"
  HREF="subroutinesnode108.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1585"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1589"
  HREF="subroutinesnode110.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1587"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1580"
  HREF="subroutinesnode108.htm">write_dbintab</A>

<B>Up:</B> <A NAME="tex2html1586"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html1590"
  HREF="subroutinesnode110.htm">write_minimal_header</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.30, 2015-10-08
</ADDRESS>
</BODY>
</HTML>
