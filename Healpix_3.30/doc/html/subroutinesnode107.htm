<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.1//EN">

<!--Converted with LaTeX2HTML 2002-2-1 (1.71)
original version by:  Nikos Drakos, CBLU, University of Leeds
* revised and updated by:  Marcus Hennecke, Ross Moore, Herb Swan
* with significant contributions from:
  Jens Lippmann, Marek Rouchal, Martin Wilck and others -->
<HTML>
<HEAD>
<TITLE>write_bintabh*</TITLE>
<META NAME="description" CONTENT="write_bintabh*">
<META NAME="keywords" CONTENT="subroutines">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<meta name="viewport" content="width=device-width, initial-scale=1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2002-2-1">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="subroutines.css">

<LINK REL="next" HREF="subroutinesnode108.htm">
<LINK REL="previous" HREF="subroutinesnode106.htm">
<LINK REL="up" HREF="subroutines.htm">
<LINK REL="next" HREF="subroutinesnode108.htm">
</HEAD>

<BODY >

<DIV CLASS="navigation"><body text="#000000" bgcolor="#FFFFFA">
<!--Navigation Panel-->
<A NAME="tex2html1555"
  HREF="subroutinesnode106.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1561"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1565"
  HREF="subroutinesnode108.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1563"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1556"
  HREF="subroutinesnode106.htm">write_bintab*</A>

<B>Up:</B> <A NAME="tex2html1562"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html1566"
  HREF="subroutinesnode108.htm">write_dbintab</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->

<H1><A NAME="SECTION0001070000000000000000"></A>
<A NAME="sub:write_bintabh"></A>
<BR>
 
</H1>

<P>
<b><font size=+6><FONT COLOR="#CC0000">write_bintabh</FONT></font></b><hr>
<H3>This routine is designed to write large (or huge) arrays into a binary table
extension of a FITS file. The user can
choose to write the array piece by piece. This is designed to deal with Time
Ordered Data set (tod).</H3>
Location in HEALPix directory tree: <a href="http://sourceforge.net/p/healpix/code/806/tree/trunk/src/f90/mod/fitstools.F90"><b>src/f90/mod/fitstools.F90</b></a>&nbsp;  

<P>
<hr><h1>FORMAT </h1><blockquote><h3>call <FONT COLOR="#CC0000">write_bintabh</FONT>(
<A HREF="#sub:write_bintabh:tod">tod</A>, <A HREF="#sub:write_bintabh:npix">npix</A>, <A HREF="#sub:write_bintabh:ntod">ntod</A>, <A HREF="#sub:write_bintabh:header">header</A>, <A HREF="#sub:write_bintabh:nlheader">nlheader</A>, <A HREF="#sub:write_bintabh:filename">filename</A>, <i><font color="#224422">[<A HREF="#sub:write_bintabh:extno">extno</A>, <A HREF="#sub:write_bintabh:firstpix">firstpix</A>, <A HREF="#sub:write_bintabh:repeat">repeat</A>]</font></i>
)</h3></blockquote>
Arguments appearing in <i><font color="#224422">italic</font></i> are
optional.

<P>
<hr><H1>ARGUMENTS</H1>

<TABLE CELLPADDING=3 BORDER="1">
<TR><TH ALIGN="LEFT" VALIGN="TOP" WIDTH=175><SPAN  CLASS="textbf">name&nbsp;&amp;&nbsp;dimensionality</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=25><SPAN  CLASS="textbf">kind</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=40><SPAN  CLASS="textbf">in/out</SPAN></TH>
<TH ALIGN="LEFT" VALIGN="TOP" WIDTH=225><SPAN  CLASS="textbf">description</SPAN></TH>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>&nbsp;</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>&nbsp;</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>
tod<A NAME="sub:write_bintabh:tod"></A>(0:npix-1,1:ntod)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>SP/ DP</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>The map or tod
  to write to the FITS file. It will be written in the file at the location
                   corresponding to pixels (or time samples)
                   <TT>firstpix</TT> to <TT>firtpix + npix</TT> -1.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>npix<A NAME="sub:write_bintabh:npix"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I8B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>Number of pixels or time samples in the map or TOD. See Note below.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>ntod<A NAME="sub:write_bintabh:ntod"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>Number of maps or tods to be written. Each of them will be in a different column of the FITS binary table.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>header<A NAME="sub:write_bintabh:header"></A>(LEN=80) (1:nlheader)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>The header for the FITS file.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>nlheader<A NAME="sub:write_bintabh:nlheader"></A></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>number of header lines to write to the file.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175>filename<A NAME="sub:write_bintabh:filename"></A>(LEN=<tt>filenamelen</tt>)</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>CHR</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>The array is written into a FITS file with this filename.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><i><font color="#224422">extno<A NAME="sub:write_bintabh:extno"></A></font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>extension number in which to write the data (0
                   based).  <b>default:</b>0</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><i><font color="#224422">firstpix<A NAME="sub:write_bintabh:firstpix"></A></font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I8B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>0 Location in the FITS file of the first
                   pixel (or time sample) to be written (0 based). <b>default:</b>
                   0. See Note below.</TD>
</TR>
<TR><TD ALIGN="LEFT" VALIGN="TOP" WIDTH=175><i><font color="#224422">repeat<A NAME="sub:write_bintabh:repeat"></A></font></i></TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=25>I4B</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=40>IN</TD>
<TD ALIGN="LEFT" VALIGN="TOP" WIDTH=225>Length of the element vector used in the binary
                   table. <b>default:</b>1024 if <TT>npix</TT> <SPAN CLASS="MATH"><IMG
 WIDTH="62" HEIGHT="19" ALIGN="BOTTOM" BORDER="0"
 SRC="subroutinesimg149.png"
 ALT="$\propto 1024$"></SPAN>; 12000 if
                   <TT>npix</TT> <SPAN CLASS="MATH">&gt; 12000</SPAN> and 1 otherwise. <BR>
Choosing a large <TT>repeat</TT> for multi-column tables (<TT>ntod</TT> <SPAN CLASS="MATH">&gt;1</SPAN>) generally
                   speeds up the I/O. It also helps bringing the number of rows
                   of the table under <SPAN CLASS="MATH">2<SUP>31</SUP></SPAN>, which is a hard limit of
                   cfitsio. <BR>
If the number of samples or pixels of each map or TOD is not a multiple of 
		<TT>repeat</TT>, then the last element vector will be padded with sentinel values 
<A HREF="subroutinesnode41.htm#sub:healpix_types:hpx_sbadval"><TT>HPX_SBADVAL</TT></A> or
<A HREF="subroutinesnode41.htm#sub:healpix_types:hpx_dbadval"><TT>HPX_DBADVAL</TT></A>.</TD>
</TR>
</TABLE>
<B>Note :</B> Indices and number of data elements larger than
                   <SPAN CLASS="MATH">2<SUP>31</SUP></SPAN> are only accessible in FITS files on computers with 64 bit
                   enabled compilers and with some specific compilation options of
                   cfitsio (see cfitsio documentation).


<P>
<HR><H1>EXAMPLE:</H1> 
<tt>use <A HREF="subroutinesnode41.htm#sub:healpix_types">healpix_types</A> 
<BR>
use fitstools, only : <FONT COLOR="#CC0000">write_bintabh</FONT>
<BR>
character(len=80), dimension(1:128) :: hdr 
<BR>
real(SP), dimension(0:49,1) :: tod 
<BR>
character(len=<A HREF="subroutinesnode41.htm#sub:healpix_types:filenamelen">FILENAMELEN</A>) :: fname='tod.fits' 
<BR>
hdr(:) = ' ' 
<BR>
tod(:,1) = 1. 
<BR>
call <FONT COLOR="#CC0000">write_bintabh</FONT>(tod, 50_i8b, 1, hdr, 128, fname, firstpix=0_i8b, repeat=10)  
<BR>
tod = tod * 3. 
<BR>
call <FONT COLOR="#CC0000">write_bintabh</FONT>(tod, 20_i8b, 1, hdr, 128, fname, firstpix=40_i8b)</tt>
<blockquote>
Writes into the FITS file `tod.fits' a 1 column binary table, where the first 40
data samples have the value <SPAN CLASS="MATH">1.</SPAN> and the next 20 have the value <SPAN CLASS="MATH">3.</SPAN> (Note that
in this example the
second call to <FONT COLOR="#CC0000">write_bintabh</FONT> overwrites some of the pixels written by the first call). The samples will be
written in element vectors of length 10. The header for the FITS file is given in the
string array <TT>hdr</TT> and its number of lines is 128. 
</blockquote>

<P>
<hr><H1>MODULES & ROUTINES</H1><H3>This section lists the modules and routines used by <FONT COLOR="#CC0000">write_bintabh</FONT>.</h3>
  <DL COMPACT><DT>
<B><SPAN  CLASS="textbf">fitstools</SPAN></B>
<DD>module, containing:
  <DT>
<B>printerror</B>
<DD>routine for printing FITS error messages.
  <DT>
<B><SPAN  CLASS="textbf">cfitsio</SPAN></B>
<DD>library for FITS file handling.		
  </DL>

<P>
<hr><H1>RELATED ROUTINES</H1><h3>This section lists the routines related to <b><FONT COLOR="#CC0000">write_bintabh</FONT></b></h3>
 
  <DL COMPACT><DT>
<B><A HREF="subroutinesnode44.htm#sub:input_tod">input_tod*</A></B>
<DD>routine that reads a file created by <FONT COLOR="#CC0000">write_bintabh</FONT>. 
  <DT>
<B><A HREF="subroutinesnode43.htm#sub:input_map">input_map</A>,
  <A HREF="subroutinesnode83.htm#sub:read_bintab">read_bintab</A></B>
<DD>routines to read <b>HEALPix</b> sky map,
  <DT>
<B><A HREF="subroutinesnode110.htm#sub:write_minimal_header">write_minimal_header</A></B>
<DD>routine to write minimal FITS header
  </DL>

<P>

<P>


<P>

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A NAME="tex2html1555"
  HREF="subroutinesnode106.htm">
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev.png"></A> 
<A NAME="tex2html1561"
  HREF="subroutines.htm">
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up.png"></A> 
<A NAME="tex2html1565"
  HREF="subroutinesnode108.htm">
<IMG WIDTH="37" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next" SRC="next.png"></A> 
<A NAME="tex2html1563"
  HREF="subroutinesnode1.htm">
<IMG WIDTH="65" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="contents" SRC="contents.png"></A>  
<BR>
<B> Previous:</B> <A NAME="tex2html1556"
  HREF="subroutinesnode106.htm">write_bintab*</A>

<B>Up:</B> <A NAME="tex2html1562"
  HREF="subroutines.htm">HEALPix/F90 subroutines</A>

<B> Next:</B> <A NAME="tex2html1566"
  HREF="subroutinesnode108.htm">write_dbintab</A>
<B> Top:</B> <a href="main.htm">Main Page</a></DIV>
<!--End of Navigation Panel-->
<ADDRESS>
Version 3.30, 2015-10-08
</ADDRESS>
</BODY>
</HTML>
